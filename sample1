using System;
using FlaUI.Core;
using FlaUI.Core.AutomationElements;
using FlaUI.Core.Definitions;
using FlaUI.UIA3;

class Program
{
    static void Main()
    {
        using (var app = Application.Launch("path_to_your_application"))
        using (var automation = new UIA3Automation())
        {
            var mainWindow = app.GetMainWindow(automation);
            var document = mainWindow.FindFirstDescendant(cf => cf.ByControlType(ControlType.Document)).AsTextPattern();

            if (document != null && document.Patterns.Text != null)
            {
                var textPattern = document.Patterns.Text.Pattern;

                // Assuming the document supports setting text through ValuePattern
                if (textPattern.DocumentRange != null)
                {
                    // Get the document range and set the text
                    textPattern.DocumentRange.Select();
                    textPattern.DocumentRange.Insert("Text with special characters: ąęłżźćńó");
                }
                else
                {
                    Console.WriteLine("TextPattern does not support document range operations.");
                }
            }
            else
            {
                Console.WriteLine("Document control or TextPattern is not available.");
            }
        }
    }
}
