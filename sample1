using Excel = Microsoft.Office.Interop.Excel;

public void SortExcelWithFilters(string filePath)
{
    // Create a new Excel application
    Excel.Application excelApp = new Excel.Application();
    
    // Open the workbook
    Excel.Workbook workbook = excelApp.Workbooks.Open(filePath);
    Excel.Worksheet worksheet = workbook.Sheets[1];

    // Turn on AutoFilter if it's not already enabled (header in the 8th row)
    Excel.Range headerRange = worksheet.Range["A8:AJ8"];  // Adjusted range to include columns up to AJ
    if (!worksheet.AutoFilterMode)
    {
        headerRange.AutoFilter();
    }

    // Sort by Column E (Oldest to Newest)
    worksheet.AutoFilter.Sort.SortFields.Clear();
    worksheet.AutoFilter.Sort.SortFields.Add(
        Key: worksheet.Columns["E"],
        SortOn: Excel.XlSortOn.xlSortOnValues,
        Order: Excel.XlSortOrder.xlAscending // Oldest to Newest
    );
    
    // Apply the sort for Column E
    worksheet.AutoFilter.ApplyFilter();

    // Sort by Column H (Smallest to Largest)
    worksheet.AutoFilter.Sort.SortFields.Clear();
    worksheet.AutoFilter.Sort
