using System;
using FlaUI.Core;
using FlaUI.Core.AutomationElements;
using FlaUI.Core.Definitions;
using FlaUI.UIA3;
using System.Windows.Forms; // Make sure to add a reference to System.Windows.Forms

class Program
{
    [STAThread]
    static void Main()
    {
        using (var app = Application.Launch("path_to_your_application"))
        using (var automation = new UIA3Automation())
        {
            var mainWindow = app.GetMainWindow(automation);
            var textBox = mainWindow.FindFirstDescendant(cf => cf.ByControlType(ControlType.Edit)).AsTextBox();

            // Set the clipboard text
            Clipboard.SetText("Text with special characters: ąęłżźćńó");

            // Set focus on the textbox
            textBox.Focus();

            // Send Ctrl+V to paste the text
            textBox.Enter(automation).Actions.Keyboard.Press(VirtualKeyShort.CONTROL, VirtualKeyShort.KEY_V).Release(VirtualKeyShort.CONTROL, VirtualKeyShort.KEY_V).Invoke();
        }
    }
}
