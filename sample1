using Excel = Microsoft.Office.Interop.Excel;

public void GetHiddenColumns(Excel.Worksheet worksheet)
{
    Excel.Range usedRange = worksheet.UsedRange;
    List<int> hiddenColumns = new List<int>();

    for (int col = 1; col <= usedRange.Columns.Count; col++)
    {
        Excel.Range column = usedRange.Columns[col];
        if (column.EntireColumn.Hidden)
        {
            hiddenColumns.Add(col);
        }
    }

    if (hiddenColumns.Count > 0)
    {
        Console.WriteLine("Hidden columns:");
        foreach (int colIndex in hiddenColumns)
        {
            Console.WriteLine("Column " + colIndex);
        }
    }
    else
    {
        Console.WriteLine("No hidden columns found.");
    }
}
