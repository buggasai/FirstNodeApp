using System;
using FlaUI.Core;
using FlaUI.Core.AutomationElements;
using FlaUI.UIA3;

class Program
{
    static void Main(string[] args)
    {
        using (var app = Application.Launch("path_to_your_application.exe"))
        {
            using (var automation = new UIA3Automation())
            {
                var mainWindow = app.GetMainWindow(automation);

                // Assuming the menu is identified by name or other properties
                var menuBar = mainWindow.FindFirstDescendant(cf => cf.ByControlType(FlaUI.Core.Definitions.ControlType.MenuBar));
                if (menuBar != null)
                {
                    var menuItem = menuBar.FindFirstDescendant(cf => cf.ByName("File"));
                    if (menuItem != null)
                    {
                        var fileMenu = menuItem.AsMenuItem();
                        fileMenu.Click();

                        var subMenuItem = fileMenu.FindFirstDescendant(cf => cf.ByName("Open"));
                        if (subMenuItem != null)
                        {
                            subMenuItem.AsMenuItem().Click();
                        }
                        else
                        {
                            Console.WriteLine("SubMenuItem 'Open' not found.");
                        }
                    }
                    else
                    {
                        Console.WriteLine("MenuItem 'File' not found.");
                    }
                }
                else
                {
                    Console.WriteLine("MenuBar not found.");
                }
            }
        }
    }
}
