using FlaUI.Core;
using FlaUI.Core.AutomationElements;
using FlaUI.Core.Definitions;

class Program
{
    static void Main()
    {
        // Create a FlaUI automation object
        using (var automation = new UIA3Automation())
        {
            // Find the window or container that contains the Group
            var window = automation.GetDesktop(); // Example: Use GetDesktop() to search the entire desktop
            var group = window.FindFirstDescendant(cf => cf.ByText("Group Name")); // Replace "Group Name" with the actual name of the Group

            // Check if the Group was found
            if (group != null)
            {
                // Find all child elements within the Group
                var children = group.FindAllChildren();

                // Loop through each child element
                foreach (var child in children)
                {
                    // Check if the child is a Text control
                    if (child.Properties.Name == "Text Control Name") // Replace "Text Control Name" with the actual name of the Text control within the Group
                    {
                        // Find the associated Edit control (assuming it's the next child element)
                        var editControl = children.FirstOrDefault(c => c.Properties.Name == "Edit Control Name"); // Replace "Edit Control Name" with the actual name of the Edit control associated with the Text control

                        // Check if the Edit control was found
                        if (editControl != null)
                        {
                            // Get the value of the Edit control
                            string editValue = editControl.AsTextBox().Text;
                            Console.WriteLine($"Edit Value: {editValue}");
                            break; // Exit the loop since we found the Edit control associated with the Text control
                        }
                        else
                        {
                            Console.WriteLine("Edit control not found associated with the Text control.");
                        }
                    }
                }
            }
            else
            {
                Console.WriteLine("Group not found in the window or container.");
            }
        }
    }
}
