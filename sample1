using FlaUI.Core;
using FlaUI.Core.AutomationElements;
using FlaUI.Core.Definitions;
using System.Collections.Generic;

class Program
{
    static void Main()
    {
        // Create a FlaUI automation object
        using (var automation = new UIA3Automation())
        {
            // Dictionary to store key-value pairs of child names and edit values
            var childEditValues = new Dictionary<string, string>();

            // Find the window or container that contains the Group
            var window = automation.GetDesktop(); // Example: Use GetDesktop() to search the entire desktop
            var group = window.FindFirstDescendant(cf => cf.ByText("Group Name")); // Replace "Group Name" with the actual name of the Group

            // Check if the Group was found
            if (group != null)
            {
                // Find all child elements within the Group
                var children = group.FindAllChildren();

                // Loop through each child element
                foreach (var child in children)
                {
                    // Check if the child is a Text control
                    if (child.Properties.ControlType == ControlType.Text) // Check if it's a Text control
                    {
                        // Find the associated Edit control (assuming it's the next child element)
                        var editControl = children.FirstOrDefault(c => c.Properties.ControlType == ControlType.Edit); // Find the corresponding Edit control

                        // Check if the Edit control was found
                        if (editControl != null)
                        {
                            // Get the value of the Edit control
                            string editValue = editControl.AsTextBox().Text;

                            // Check if the value is not a duplicate
                            if (!childEditValues.ContainsValue(editValue))
                            {
                                // Add the key-value pair to the dictionary
                                childEditValues[child.Properties.Name] = editValue;
                                Console.WriteLine($"Added key-value pair: Key='{child.Properties.Name}', Value='{editValue}'");
                            }
                            else
                            {
                                Console.WriteLine($"Skipping duplicate value: '{editValue}'");
                            }
                        }
                        else
                        {
                            Console.WriteLine("Edit control not found associated with the Text control.");
                        }
                    }
                }
            }
            else
            {
                Console.WriteLine("Group not found in the window or container.");
            }
        }
    }
}
