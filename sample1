using FlaUI.Core.AutomationElements;
using FlaUI.Core.Conditions;
using FlaUI.Core.Definitions;
using FlaUI.Core.Tools;

// Attach to the running application
var app = Application.Attach("YourApplicationName");

// Find the main window
var mainWindow = app.GetMainWindow();

// Find the first level of pane element
var mainPane = mainWindow.FindFirstChild(x => x.ByControlType(ControlType.Pane));

if (mainPane != null)
{
    // Find nested pane elements under the main pane
    var nestedPanes = mainPane.FindAllDescendants(x => x.ByControlType(ControlType.Pane));

    foreach (var nestedPane in nestedPanes)
    {
        // Find document elements under each nested pane
        var documents = nestedPane.FindAllDescendants(x => x.ByControlType(ControlType.Document));

        foreach (var document in documents)
        {
            // Access child elements within the document
            var childElements = document.FindAllChildren();

            foreach (var childElement in childElements)
            {
                // Inspect properties of each child element
                string name = childElement.Properties.Name.ValueOrDefault;
                string automationId = childElement.Properties.AutomationId.ValueOrDefault;
                string controlType = childElement.ControlType.ToString();

                // Print out properties for debugging
                Console.WriteLine($"Name: {name}, AutomationId: {automationId}, ControlType: {controlType}");

                // You can further explore child elements, access their properties, and interact with them as needed
            }
        }
    }
}
else
{
    Console.WriteLine("Main pane element not found.");
}
