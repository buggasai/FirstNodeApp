using System;
using Excel = Microsoft.Office.Interop.Excel;

class Program
{
    static void Main()
    {
        // Start Excel and get Application object.
        Excel.Application excelApp = new Excel.Application
        {
            Visible = true // Set to true if you want to see Excel UI
        };

        // Open the existing workbook
        Excel.Workbook workbook = excelApp.Workbooks.Open("your_excel_file_path.xlsx");
        Excel.Worksheet worksheet = workbook.Sheets[1];

        // Get the value of cell F2
        string cellF2Value = worksheet.Cells[2, 6].Value as string;

        // Check if the value is "Mandan"
        if (string.Equals(cellF2Value, "Mandan", StringComparison.OrdinalIgnoreCase))
        {
            // Delete columns F to I
            Excel.Range columnsToDelete = worksheet.Range["F:I"];
            columnsToDelete.Delete(Excel.XlDeleteShiftDirection.xlShiftToLeft);
        }

        // Save and close the workbook
        workbook.Save();
        workbook.Close();
        excelApp.Quit();

        // Release COM objects
        ReleaseObject(worksheet);
        ReleaseObject(workbook);
        ReleaseObject(excelApp);
    }

    private static void ReleaseObject(object obj)
    {
        try
        {
            System.Runtime.InteropServices.Marshal.ReleaseComObject(obj);
            obj = null;
        }
        catch (Exception ex)
        {
            obj = null;
            Console.WriteLine("Exception occurred while releasing object " + ex.ToString());
        }
        finally
        {
            GC.Collect();
        }
    }
}
