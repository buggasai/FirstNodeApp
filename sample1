using System;
using Excel = Microsoft.Office.Interop.Excel;

class Program
{
    static void Main()
    {
        // Start Excel application
        Excel.Application excelApp = new Excel.Application();
        
        // Make Excel visible (optional)
        excelApp.Visible = true;

        // Open the Excel file
        string filePath = "your_excel_file.xlsx";
        Excel.Workbook workbook = excelApp.Workbooks.Open(filePath);
        Excel.Worksheet worksheet = workbook.Sheets[1]; // Assumes the first worksheet

        // Insert a new column before column A
        Excel.Range columnA = worksheet.Columns["A"];
        columnA.Insert(Excel.XlInsertShiftDirection.xlShiftToRight);

        // Copy values from the original column A to the new column A
        Excel.Range originalColumnA = worksheet.Columns["B"]; // Original data is now in column B
        Excel.Range newColumnA = worksheet.Columns["A"];
        originalColumnA.Copy(newColumnA);

        // Save the changes
        workbook.Save();

        // Cleanup
        workbook.Close(false);
        excelApp.Quit();
        
        // Release COM objects
        System.Runtime.InteropServices.Marshal.ReleaseComObject(newColumnA);
        System.Runtime.InteropServices.Marshal.ReleaseComObject(originalColumnA);
        System.Runtime.InteropServices.Marshal.ReleaseComObject(columnA);
        System.Runtime.InteropServices.Marshal.ReleaseComObject(worksheet);
        System.Runtime.InteropServices.Marshal.ReleaseComObject(workbook);
        System.Runtime.InteropServices.Marshal.ReleaseComObject(excelApp);

        Console.WriteLine("Operation completed successfully.");
    }
}
