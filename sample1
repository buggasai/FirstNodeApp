using System;
using System.Runtime.InteropServices;
using Excel = Microsoft.Office.Interop.Excel;

class Program
{
    static void Main(string[] args)
    {
        string filePath = @"C:\path\to\your\file.xlsx";
        string sourceSheetName = "Sheet1"; // The source sheet
        string destinationSheetName = "Auswertung StB"; // The destination sheet

        Excel.Application excelApp = new Excel.Application();
        Excel.Workbook workbook = null;

        try
        {
            // Open the workbook
            workbook = excelApp.Workbooks.Open(filePath);

            Excel.Worksheet sourceSheet = workbook.Sheets[sourceSheetName] as Excel.Worksheet;
            Excel.Worksheet destinationSheet = workbook.Sheets[destinationSheetName] as Excel.Worksheet;

            if (sourceSheet != null && destinationSheet != null)
            {
                // Select and copy columns A-G from the source sheet
                Excel.Range sourceRange = sourceSheet.Range["A:G"];
                sourceRange.Copy();

                // Paste values into columns A-G of the destination sheet
                Excel.Range destinationRange = destinationSheet.Range["A1"];
                destinationRange.PasteSpecial(Excel.XlPasteType.xlPasteValues);

                // Clear the clipboard to prevent Excel from asking about keeping copied data
                excelApp.CutCopyMode = 0;

                // Save the workbook
                workbook.Save();
                Console.WriteLine("Data copied from columns A-G and pasted as values in 'Auswertung StB'.");
            }
            else
            {
                Console.WriteLine($"One or both sheets '{sourceSheetName}' or '{destinationSheetName}' not found.");
            }
        }
        catch (Exception ex)
        {
            Console.WriteLine($"An error occurred: {ex.Message}");
        }
        finally
        {
            // Clean up
            if (workbook != null)
            {
                workbook.Close(false);
                Marshal.ReleaseComObject(workbook);
            }
            excelApp.Quit();
            Marshal.ReleaseComObject(excelApp);
        }
    }
}
