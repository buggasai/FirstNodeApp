using FlaUI.Core.AutomationElements;
using FlaUI.Core.Conditions;
using FlaUI.Core.Definitions;
using FlaUI.Core.Tools;

// Attach to the running application
var app = Application.Attach("YourApplicationName");

// Find the main window
var mainWindow = app.GetMainWindow();

// Define a method to explore child elements recursively
void ExploreElements(AutomationElement parentElement)
{
    // Access child elements within the parent element
    var childElements = parentElement.FindAllChildren();

    foreach (var childElement in childElements)
    {
        // Inspect properties of each child element
        string name = childElement.Properties.Name.ValueOrDefault;
        string automationId = childElement.Properties.AutomationId.ValueOrDefault;
        string controlType = childElement.ControlType.ToString();

        // Print out properties for debugging
        Console.WriteLine($"Name: {name}, AutomationId: {automationId}, ControlType: {controlType}");

        // Recursively explore child elements if the control type is Pane
        if (childElement.ControlType == ControlType.Pane)
        {
            ExploreElements(childElement);
        }
    }
}

// Find the first level of pane element
var mainPane = mainWindow.FindFirstChild(x => x.ByControlType(ControlType.Pane));

if (mainPane != null)
{
    // Explore child elements recursively starting from the main pane
    ExploreElements(mainPane);
}
else
{
    Console.WriteLine("Main pane element not found.");
}
