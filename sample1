using FlaUI.Core;
using FlaUI.Core.AutomationElements;
using FlaUI.Core.AutomationElements.Infrastructure;
using FlaUI.Core.Conditions;
using FlaUI.Core.Definitions;

class Program
{
    static void Main()
    {
        // Create a FlaUI automation object
        using (var automation = new UIA3Automation())
        {
            // Find the window with the specified title
            var condition = new PropertyCondition(AutomationObjectIds.NameProperty, "TheadwaitDiallogwindow");
            var window = automation.GetDesktop().FindFirst(TreeScope.Children, condition);

            // Check if the window was found
            if (window != null)
            {
                // Find the textbox element in the window
                var textBox = window.FindFirstDescendant(cf => cf.ByControlType(ControlType.Edit));

                // Check if the textbox was found
                if (textBox != null)
                {
                    // Get the value of the textbox
                    string textBoxValue = textBox.AsTextBox().Text;
                    Console.WriteLine($"Textbox Value: {textBoxValue}");
                }
                else
                {
                    Console.WriteLine("Textbox not found in the window.");
                }
            }
            else
            {
                Console.WriteLine("Window not found.");
            }
        }
    }
}
