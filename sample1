using System;
using System.Runtime.InteropServices;
using Excel = Microsoft.Office.Interop.Excel;

class Program
{
    static void Main()
    {
        // Create a new Excel application
        Excel.Application excelApp = new Excel.Application();

        // Make the application visible (optional)
        excelApp.Visible = false;

        // Define the paths to the source and destination workbooks
        string sourceFilePath = @"C:\path\to\source\file.xlsx";
        string destinationFilePath = @"C:\path\to\destination\file.xlsx";

        // Open the source workbook
        Excel.Workbook sourceWorkbook = excelApp.Workbooks.Open(sourceFilePath);
        Excel.Worksheet sourceWorksheet = (Excel.Worksheet)sourceWorkbook.Sheets[1]; // Adjust the sheet index if necessary

        // Define the source range from A2 downwards till the last row and last column
        Excel.Range sourceRange = sourceWorksheet.Range["A2", sourceWorksheet.Cells[sourceWorksheet.Rows.Count, sourceWorksheet.Columns.Count].End(Excel.XlDirection.xlUp)];

        // Copy the values from the source range
        object[,] sourceValues = sourceRange.Value2;

        // Close the source workbook
        sourceWorkbook.Close(false);

        // Open the destination workbook
        Excel.Workbook destinationWorkbook = excelApp.Workbooks.Open(destinationFilePath);
        Excel.Worksheet destinationWorksheet = (Excel.Worksheet)destinationWorkbook.Sheets[1]; // Adjust the sheet index if necessary

        // Define the range to clear starting from A9 downwards till the last row and column
        Excel.Range clearStartCell = destinationWorksheet.Cells[9, 1];
        Excel.Range clearEndCell = destinationWorksheet.Cells[destinationWorksheet.Rows.Count, destinationWorksheet.Columns.Count];
        Excel.Range clearRange = destinationWorksheet.Range[clearStartCell, clearEndCell];

        // Clear the contents of the defined range
        clearRange.ClearContents();

        // Define the destination range where the values will be inserted starting from A9
        int rowsCount = sourceValues.GetLength(0);
        int colsCount = sourceValues.GetLength(1);
        Excel.Range destinationStartCell = destinationWorksheet.Cells[9, 1];
        Excel.Range destinationEndCell = destinationWorksheet.Cells[8 + rowsCount, colsCount];
        Excel.Range destinationRange = destinationWorksheet.Range[destinationStartCell, destinationEndCell];

        // Insert the copied values into the destination range
        destinationRange.Value2 = sourceValues;

        // Save and close the destination workbook
        destinationWorkbook.Save();
        destinationWorkbook.Close(false);

        // Quit the Excel application
        excelApp.Quit();

        // Clean up
        Marshal.ReleaseComObject(sourceRange);
        Marshal.ReleaseComObject(destinationRange);
        Marshal.ReleaseComObject(clearRange);
        Marshal.ReleaseComObject(sourceWorksheet);
        Marshal.ReleaseComObject(destinationWorksheet);
        Marshal.ReleaseComObject(sourceWorkbook);
        Marshal.ReleaseComObject(destinationWorkbook);
        Marshal.ReleaseComObject(excelApp);

        GC.Collect();
        GC.WaitForPendingFinalizers();
    }
}
