using System;
using System.Runtime.InteropServices;
using Excel = Microsoft.Office.Interop.Excel;

class Program
{
    static void Main()
    {
        // Create a new Excel application
        Excel.Application excelApp = new Excel.Application();

        // Make the application visible (optional)
        excelApp.Visible = false;

        // Define the path to the workbook
        string filePath = @"C:\path\to\file.xlsx";

        // Open the workbook
        Excel.Workbook workbook = excelApp.Workbooks.Open(filePath);
        Excel.Worksheet worksheet = (Excel.Worksheet)workbook.Sheets[1]; // Adjust the sheet index if necessary

        // Define the range to clear starting from A9 downwards till the last row and last column
        Excel.Range clearStartCell = worksheet.Cells[9, 1];
        Excel.Range lastCell = worksheet.Cells[worksheet.Rows.Count, worksheet.Columns.Count].End(Excel.XlDirection.xlUp);
        Excel.Range clearRange = worksheet.Range[clearStartCell, lastCell];

        // Clear the contents of the defined range
        clearRange.ClearContents();

        // Save and close the workbook
        workbook.Save();
        workbook.Close(false);

        // Quit the Excel application
        excelApp.Quit();

        // Clean up
        Marshal.ReleaseComObject(clearRange);
        Marshal.ReleaseComObject(clearStartCell);
        Marshal.ReleaseComObject(lastCell);
        Marshal.ReleaseComObject(worksheet);
        Marshal.ReleaseComObject(workbook);
        Marshal.ReleaseComObject(excelApp);

        GC.Collect();
        GC.WaitForPendingFinalizers();
    }
}
