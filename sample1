using System;
using System.Collections.Generic;
using Excel = Microsoft.Office.Interop.Excel;

class Program
{
    static void Main()
    {
        // Define the list of expected column names
        List<string> expectedColumns = new List<string>
        {
            "Column1", "Column2", "Column3", "Column4"
        };

        // Create a list to store missing columns
        List<string> missingColumns = new List<string>();

        // Initialize Excel application
        Excel.Application excelApp = new Excel.Application();
        Excel.Workbook workbook = excelApp.Workbooks.Open(@"C:\path\to\your\file.xlsx");
        Excel.Worksheet worksheet = workbook.Sheets[1];

        // Read the first row (assuming it's the header row) to get column names
        Excel.Range headerRow = worksheet.Rows[1];
        int lastColumn = headerRow.Columns.Count;

        // Create a list to store the actual columns found in the worksheet
        List<string> actualColumns = new List<string>();

        // Loop through the header row and store column names
        for (int col = 1; col <= lastColumn; col++)
        {
            Excel.Range cell = headerRow.Cells[1, col] as Excel.Range;
            if (cell != null && cell.Value2 != null)
            {
                actualColumns.Add(cell.Value2.ToString());
            }
        }

        // Compare expected columns with actual columns
        foreach (var expectedColumn in expectedColumns)
        {
            if (!actualColumns.Contains(expectedColumn))
            {
                missingColumns.Add(expectedColumn);
            }
        }

        // Display missing columns
        if (missingColumns.Count > 0)
        {
            Console.WriteLine("Missing columns:");
            foreach (var column in missingColumns)
            {
                Console.WriteLine(column);
            }
        }
        else
        {
            Console.WriteLine("All expected columns are present.");
        }

        // Clean up
        workbook.Close(false);
        excelApp.Quit();
    }
}
