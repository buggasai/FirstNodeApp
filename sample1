using Excel = Microsoft.Office.Interop.Excel;

class Program
{
    static void Main(string[] args)
    {
        // Initialize Excel application
        Excel.Application excelApp = new Excel.Application();
        
        // Open workbook (replace with your file path)
        Excel.Workbook workbook = excelApp.Workbooks.Open(@"C:\path\to\your\excel.xlsx");
        
        // Access the worksheet named "fakturadaten"
        Excel.Worksheet worksheet = workbook.Sheets["fakturadaten"];
        
        // Find the last non-empty row in column C
        Excel.Range lastCell = worksheet.Cells[worksheet.Rows.Count, 3].End(Excel.XlDirection.xlUp);
        
        // Get the row number of the last non-empty cell
        int lastRow = lastCell.Row;
        
        // Get the value of the cell just above the last non-empty cell (lastCell - 1)
        Excel.Range previousCell = worksheet.Cells[lastRow - 1, 3];
        
        // Get the value in the previous cell (assuming it's a date)
        DateTime previousDate = Convert.ToDateTime(previousCell.Value);
        
        // Output the value (or do something with it)
        Console.WriteLine("The date in the cell above the last one in column C is: " + previousDate.ToShortDateString());
        
        // Cleanup
        workbook.Close(false);
        excelApp.Quit();
    }
}
