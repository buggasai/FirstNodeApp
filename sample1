using Excel = Microsoft.Office.Interop.Excel;

class Program
{
    static void Main()
    {
        Excel.Application excelApp = new Excel.Application();
        Excel.Workbook workbook = excelApp.Workbooks.Open(@"C:\path\to\your\workbook.xlsx");
        Excel.Worksheet worksheet = workbook.Sheets[1];

        // Specify the range you want to sort
        Excel.Range sortRange = worksheet.UsedRange;

        // Set the row with headers
        int headerRow = 8;

        // Sort by Column B (smallest to largest)
        sortRange.Sort(
            sortRange.Columns[2], // Column B
            Excel.XlSortOrder.xlAscending,
            Type.Missing, Type.Missing, Excel.XlSortOrder.xlAscending,
            Type.Missing, Excel.XlSortOrder.xlAscending,
            Excel.XlYesNoGuess.xlYes,
            Type.Missing, Type.Missing,
            Excel.XlSortOrientation.xlSortColumns,
            Excel.XlSortMethod.xlPinYin,
            Excel.XlSortDataOption.xlSortNormal
        );

        // Sort by Column H (smallest to largest)
        sortRange.Sort(
            sortRange.Columns[8], // Column H
            Excel.XlSortOrder.xlAscending,
            Type.Missing, Type.Missing, Excel.XlSortOrder.xlAscending,
            Type.Missing, Excel.XlSortOrder.xlAscending,
            Excel.XlYesNoGuess.xlYes,
            Type.Missing, Type.Missing,
            Excel.XlSortOrientation.xlSortColumns,
            Excel.XlSortMethod.xlPinYin,
            Excel.XlSortDataOption.xlSortNormal
        );

        // Sort by Column E (oldest to newest)
        sortRange.Sort(
            sortRange.Columns[5], // Column E
            Excel.XlSortOrder.xlAscending,
            Type.Missing, Type.Missing, Excel.XlSortOrder.xlAscending,
            Type.Missing, Excel.XlSortOrder.xlAscending,
            Excel.XlYesNoGuess.xlYes,
            Type.Missing, Type.Missing,
            Excel.XlSortOrientation.xlSortColumns,
            Excel.XlSortMethod.xlPinYin,
            Excel.XlSortDataOption.xlSortNormal
        );

        // Save and close the workbook
        workbook.Save();
        workbook.Close();
        excelApp.Quit();
    }
}
