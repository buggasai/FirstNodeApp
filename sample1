using FlaUI.Core;
using FlaUI.Core.AutomationElements;
using FlaUI.Core.Definitions;

class Program
{
    static void Main()
    {
        // Create a FlaUI automation object
        using (var automation = new UIA3Automation())
        {
            // Find the window or container that contains the Group
            var window = automation.GetDesktop(); // Example: Use GetDesktop() to search the entire desktop
            var group = window.FindFirstDescendant(cf => cf.ByText("Group Name")); // Replace "Group Name" with the actual name of the Group

            // Check if the Group was found
            if (group != null)
            {
                // Find the Text control within the Group
                var textControl = group.FindFirstDescendant(cf => cf.ByText("Text Control Name")); // Replace "Text Control Name" with the actual name of the Text control

                // Check if the Text control was found
                if (textControl != null)
                {
                    // Find the associated Edit control (assuming it's the next sibling)
                    var editControl = textControl.NextSibling.FindFirstChild(cf => cf.ByControlType(ControlType.Edit));

                    // Check if the Edit control was found
                    if (editControl != null)
                    {
                        // Get the value of the Edit control
                        string editValue = editControl.AsTextBox().Text;
                        Console.WriteLine($"Edit Value: {editValue}");
                    }
                    else
                    {
                        Console.WriteLine("Edit control not found associated with the Text control.");
                    }
                }
                else
                {
                    Console.WriteLine("Text control not found within the Group.");
                }
            }
            else
            {
                Console.WriteLine("Group not found in the window or container.");
            }
        }
    }
}
