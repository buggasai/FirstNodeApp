using System;
using System.Diagnostics;
using System.Windows.Automation;

class Program
{
    static void Main()
    {
        // Specify the path to the application executable
        string applicationPath = @"C:\Path\To\Your\Application.exe";

        // Launch the application
        Process process = Process.Start(applicationPath);

        // Wait for the application to load
        process.WaitForInputIdle();

        // Find the element to click (e.g., a button)
        AutomationElement rootElement = AutomationElement.FromHandle(process.MainWindowHandle);
        AutomationElement buttonElement = FindElementByAutomationId(rootElement, "myButton");

        // Perform a click action on the button
        if (buttonElement != null)
        {
            InvokePattern invokePattern = buttonElement.GetCurrentPattern(InvokePattern.Pattern) as InvokePattern;
            invokePattern?.Invoke();

            Console.WriteLine("Button clicked successfully.");
        }
        else
        {
            Console.WriteLine("Button not found.");
        }

        // Close the application
        process.CloseMainWindow();
    }

    static AutomationElement FindElementByAutomationId(AutomationElement parentElement, string automationId)
    {
        Condition condition = new PropertyCondition(AutomationElement.AutomationIdProperty, automationId);
        return parentElement.FindFirst(TreeScope.Descendants, condition);
    }
}
