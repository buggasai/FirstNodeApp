AutoItX3 autoIt = new AutoItX3();

// Check if the window exists
if (autoIt.WinExists("[CLASS:YourClassName]") != 0)
{
    // Check if the window is active
    if (autoIt.WinActive("[CLASS:YourClassName]") != 0)
    {
        // Check if the window is visible and not minimized
        int state = autoIt.WinGetState("[CLASS:YourClassName]");
        
        if ((state & 2) != 0) // 2: Visible
        {
            if ((state & 16) == 0) // 16: Minimized (0 if not minimized)
            {
                Console.WriteLine("Window is active, visible, and not minimized.");
            }
            else
            {
                throw new Exception("Window is minimized.");
            }
        }
        else
        {
            throw new Exception("Window is not visible.");
        }
    }
    else
    {
        throw new Exception("Window exists but is not active.");
    }
}
else
{
    throw new Exception("Window not found.");
}
