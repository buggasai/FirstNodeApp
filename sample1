using System;
using Microsoft.Office.Interop.Excel;

class Program
{
    static void Main()
    {
        Application excelApp = new Application();
        Workbook sourceWorkbook = excelApp.Workbooks.Open(@"C:\Path\To\Source.xlsx");
        Workbook targetWorkbook = excelApp.Workbooks.Open(@"C:\Path\To\Target.xlsx");

        Worksheet sourceWorksheet = sourceWorkbook.Sheets[1];
        Worksheet targetWorksheet = targetWorkbook.Sheets[1];

        // Copy "ADP" column
        CopyColumnData(sourceWorksheet, targetWorksheet, "ADP");

        // Copy "Client Pay Element" column with modification
        CopyClientPayElement(sourceWorksheet, targetWorksheet, "Client Pay Element");

        // Save and close the workbooks
        targetWorkbook.Save();
        targetWorkbook.Close(false);
        sourceWorkbook.Close(false);
        excelApp.Quit();
    }

    // Helper function to copy data from a specific column
    static void CopyColumnData(Worksheet sourceWorksheet, Worksheet targetWorksheet, string columnName)
    {
        int sourceColumnIndex = FindColumnIndexByName(sourceWorksheet, columnName);
        int targetColumnIndex = FindColumnIndexByName(targetWorksheet, columnName);

        if (sourceColumnIndex != -1 && targetColumnIndex != -1)
        {
            Range sourceRange = sourceWorksheet.UsedRange.Columns[sourceColumnIndex];
            Range targetRange = targetWorksheet.Columns[targetColumnIndex];

            targetRange.ClearContents();
            sourceRange.Copy();
            targetRange.PasteSpecial(XlPasteType.xlPasteValues);
        }
    }

    // Helper function to copy and modify "Client Pay Element" column
    static void CopyClientPayElement(Worksheet sourceWorksheet, Worksheet targetWorksheet, string columnName)
    {
        int sourceColumnIndex = FindColumnIndexByName(sourceWorksheet, columnName);
        int targetColumnIndex = FindColumnIndexByName(targetWorksheet, columnName);

        if (sourceColumnIndex != -1 && targetColumnIndex != -1)
        {
            Range sourceRange = sourceWorksheet.UsedRange.Columns[sourceColumnIndex];
            Range targetRange = targetWorksheet.Columns[targetColumnIndex];

            targetRange.ClearContents();

            int rowCount = sourceRange.Rows.Count;
            for (int row = 2; row <= rowCount; row++) // Assuming first row is the header
            {
                string clientCode = "client code-"; // Modify as needed
                string originalValue = (sourceRange.Cells[row, 1] as Range).Value?.ToString();
                string newValue = clientCode + originalValue;

                targetWorksheet.Cells[row, targetColumnIndex].Value = newValue;
            }
        }
    }

    // Helper function to find the column index by name
    static int FindColumnIndexByName(Worksheet worksheet, string columnName)
    {
        Range usedRange = worksheet.UsedRange;
        for (int col = 1; col <= usedRange.Columns.Count; col++)
        {
            if ((usedRange.Cells[1, col] as Range).Value?.ToString() == columnName)
            {
                return col;
            }
        }
        return -1;
    }
}
