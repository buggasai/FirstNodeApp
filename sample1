using System;
using System.Runtime.InteropServices;
using Excel = Microsoft.Office.Interop.Excel;

class Program
{
    static void Main(string[] args)
    {
        string filePath = @"C:\path\to\your\file.xlsx";
        string sheetName = "Sheet1"; // The sheet where the operation will be performed

        Excel.Application excelApp = new Excel.Application();
        Excel.Workbook workbook = null;
        Excel.Worksheet worksheet = null;

        try
        {
            // Open the workbook
            workbook = excelApp.Workbooks.Open(filePath);
            worksheet = workbook.Sheets[sheetName] as Excel.Worksheet;

            if (worksheet != null)
            {
                // Define the source range (column C)
                Excel.Range sourceRange = worksheet.Columns["C"];

                // Define the destination range (column D)
                Excel.Range destinationRange = worksheet.Columns["D"];

                // Copy values from column C to column D
                sourceRange.Copy();
                destinationRange.PasteSpecial(Excel.XlPasteType.xlPasteValues);

                // Clear the clipboard to prevent Excel from asking about keeping copied data
                excelApp.CutCopyMode = 0;

                // Save the workbook
                workbook.Save();
                Console.WriteLine("Values from column C copied to column D successfully.");
            }
            else
            {
                Console.WriteLine($"Sheet '{sheetName}' not found.");
            }
        }
        catch (Exception ex)
        {
            Console.WriteLine($"An error occurred: {ex.Message}");
        }
        finally
        {
            // Clean up
            if (workbook != null)
            {
                workbook.Close(false);
                Marshal.ReleaseComObject(workbook);
            }
            excelApp.Quit();
            Marshal.ReleaseComObject(excelApp);
        }
    }
}
