using FlaUI.Core.AutomationElements;
using FlaUI.Core.Tools;

namespace FlaUIExample
{
    class Program
    {
        static void Main(string[] args)
        {
            // Start your application and get the main window
            var app = Application.Launch("YourApplication.exe");
            var mainWindow = app.GetMainWindow();

            // Find the panel by its automation id
            var panel = mainWindow.FindFirstDescendant(cf => cf.ByAutomationId("panel1"));

            // Check if the panel has a column named "PESEL"
            bool hasPESELColumn = CheckForColumn(panel, "PESEL");

            // Close the application when done
            app.Close();
        }

        static bool CheckForColumn(AutomationElement panel, string columnName)
        {
            // Iterate through the child elements of the panel
            foreach (var child in panel.FindAllChildren())
            {
                // Check if the child element is a data grid
                if (child.ControlType == FlaUI.Core.Definitions.ControlType.DataGrid)
                {
                    // Get the headers of the data grid
                    var headers = child.FindAllDescendants(cf => cf.ByControlType(FlaUI.Core.Definitions.ControlType.Header));

                    // Iterate through the headers to check if the column name exists
                    foreach (var header in headers)
                    {
                        if (header.Name == columnName)
                        {
                            // Column found
                            return true;
                        }
                    }
                }
            }
            
            // Column not found
            return false;
        }
    }
}
