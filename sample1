using System;
using HtmlAgilityPack;

class HtmlParserExample
{
    public void FindOptionInSelect(string htmlFilePath, string selectId, string optionText)
    {
        // Load the HTML document
        var htmlDoc = new HtmlDocument();
        htmlDoc.Load(htmlFilePath);

        try
        {
            // Define the XPath to locate the <select> element with the specific id
            string selectXpath = $"//select[@id='{selectId}']";

            // Find the <select> node
            var selectNode = htmlDoc.DocumentNode.SelectSingleNode(selectXpath);

            if (selectNode != null)
            {
                // Define the XPath to locate the <option> element with the specific text within the <select>
                string optionXpath = $"//select[@id='{selectId}']//option[text()='{optionText}']";

                // Find the <option> node
                var optionNode = htmlDoc.DocumentNode.SelectSingleNode(optionXpath);

                // Check if the <option> node is found and get its value or inner text
                if (optionNode != null)
                {
                    string optionValue = optionNode.GetAttributeValue("value", string.Empty);
                    Console.WriteLine($"The value of the option with text '{optionText}' is: {optionValue}");
                }
                else
                {
                    Console.WriteLine($"Option with text '{optionText}' not found.");
                }
            }
            else
            {
                Console.WriteLine($"Select element with id '{selectId}' not found.");
            }
        }
        catch (Exception ex)
        {
            Console.WriteLine("Error: " + ex.Message);
        }
    }
}

class Program
{
    static void Main(string[] args)
    {
        HtmlParserExample example = new HtmlParserExample();
        example.FindOptionInSelect("path_to_your_html_file.html", "your_select_id", "your_option_text");
    }
}
