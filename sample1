using System;
using Excel = Microsoft.Office.Interop.Excel;

class Program
{
    static void Main()
    {
        // Start Excel application
        Excel.Application excelApp = new Excel.Application();
        
        // Make Excel visible (optional)
        excelApp.Visible = false;

        // Open the Excel file
        string filePath = "your_excel_file.xlsx";
        Excel.Workbook workbook = excelApp.Workbooks.Open(filePath);
        Excel.Worksheet worksheet = workbook.Sheets[1]; // Assumes the first worksheet

        // Insert a new column before column A
        Excel.Range columnA = worksheet.Columns["A"];
        columnA.Insert(Excel.XlInsertShiftDirection.xlShiftToRight);

        // Get the used range of the worksheet
        Excel.Range usedRange = worksheet.UsedRange;

        // Copy values from the original column A (now column B) to the new column A
        for (int row = 1; row <= usedRange.Rows.Count; row++)
        {
            worksheet.Cells[row, 1].Value = worksheet.Cells[row, 2].Value;
        }

        // Save the changes
        workbook.Save();

        // Cleanup
        workbook.Close(false);
        excelApp.Quit();
        
        // Release COM objects
        System.Runtime.InteropServices.Marshal.ReleaseComObject(columnA);
        System.Runtime.InteropServices.Marshal.ReleaseComObject(usedRange);
        System.Runtime.InteropServices.Marshal.ReleaseComObject(worksheet);
        System.Runtime.InteropServices.Marshal.ReleaseComObject(workbook);
        System.Runtime.InteropServices.Marshal.ReleaseComObject(excelApp);

        Console.WriteLine("Operation completed successfully.");
    }
}
