using System;
using Microsoft.Office.Interop.Excel;
using System.Runtime.InteropServices;

class ExcelReader
{
    public void SearchAndReadValues(string excelFilePath, string searchValue)
    {
        Application excelApp = new Application();
        Workbook workbook = null;
        Worksheet worksheet = null;
        Range foundRange = null;

        try
        {
            // Open the Excel file
            workbook = excelApp.Workbooks.Open(excelFilePath);
            worksheet = (Worksheet)workbook.Sheets[1]; // Get the first worksheet

            // Get the range for column A
            Range columnARange = worksheet.Columns["A:A"];

            // Find the cell in column A with the search value
            foundRange = columnARange.Find(searchValue, Type.Missing, XlFindLookIn.xlValues, XlLookAt.xlWhole, XlSearchOrder.xlByRows, XlSearchDirection.xlNext, false, Type.Missing, Type.Missing);

            if (foundRange != null)
            {
                int foundRow = foundRange.Row;

                // Read the values from the found row
                for (int col = 1; col <= worksheet.Cells.SpecialCells(XlCellType.xlCellTypeLastCell).Column; col++)
                {
                    Range cell = (Range)worksheet.Cells[foundRow, col];
                    string cellValue = cell.Value2 != null ? cell.Value2.ToString() : string.Empty;
                    Console.WriteLine($"Row {foundRow}, Column {col}: {cellValue}");
                }
            }
            else
            {
                Console.WriteLine($"Value '{searchValue}' not found in column A.");
            }
        }
        catch (Exception ex)
        {
            Console.WriteLine("Error: " + ex.Message);
        }
        finally
        {
            // Cleanup
            if (foundRange != null) Marshal.ReleaseComObject(foundRange);
            if (worksheet != null) Marshal.ReleaseComObject(worksheet);
            if (workbook != null)
            {
                workbook.Close(false);
                Marshal.ReleaseComObject(workbook);
            }
            if (excelApp != null)
            {
                excelApp.Quit();
                Marshal.ReleaseComObject(excelApp);
            }
        }
    }
}

class Program
{
    static void Main(string[] args)
    {
        ExcelReader reader = new ExcelReader();
        reader.SearchAndReadValues("path_to_your_excel_file.xlsx", "your_search_value");
    }
}
