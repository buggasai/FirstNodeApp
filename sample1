using FlaUI.Core;
using FlaUI.Core.AutomationElements;
using FlaUI.Core.Conditions;
using FlaUI.Core.Definitions;

class Program
{
    static void Main()
    {
        // Create a FlaUI automation object
        using (var automation = new UIA3Automation())
        {
            // Find all windows on the desktop
            var desktop = automation.GetDesktop();
            var windows = desktop.FindAll(TreeScope.Children, Condition.TrueCondition);

            // Print titles of all windows found on the desktop (for debugging)
            foreach (var window in windows)
            {
                Console.WriteLine($"Window Title: {window.Properties.Name}");
            }

            // Find the window with the specified title
            var condition = new PropertyCondition(AutomationObjectIds.NameProperty, "TheadwaitDiallogwindow");
            var window = desktop.FindFirst(TreeScope.Children, condition);

            // Check if the window was found
            if (window != null)
            {
                // Continue with the rest of the code
            }
            else
            {
                Console.WriteLine("Window not found. Make sure the application is running and the window is open.");
            }
        }
    }
}
