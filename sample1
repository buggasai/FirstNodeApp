using System;
using FlaUI.Core;
using FlaUI.Core.AutomationElements;
using FlaUI.UIA3;
using System.Diagnostics;

class Program
{
    static void Main(string[] args)
    {
        // Adjust the path to your executable
        string appPath = @"C:\Path\To\YourApplication.exe"; // Replace with the actual path to your application

        // Launch or attach to the application
        var application = Application.AttachOrLaunch(new ProcessStartInfo
        {
            FileName = appPath
        });

        using (var automation = new UIA3Automation())
        {
            // Get the main window of the application
            var window = application.GetMainWindow(automation, TimeSpan.FromSeconds(10)); // Adjust the timeout as needed

            if (window == null)
            {
                Console.WriteLine("Main window not found.");
                return;
            }

            // Find the textbox element by its AutomationId or other properties
            var textBox = window.FindFirstDescendant(cf => cf.ByControlType(FlaUI.Core.Definitions.ControlType.Edit));

            if (textBox != null)
            {
                // Retrieve the value from the textbox
                var textBoxValue = textBox.AsTextBox().Text;
                Console.WriteLine($"TextBox value: {textBoxValue}");
            }
            else
            {
                Console.WriteLine("TextBox not found.");
            }
        }
    }
}
