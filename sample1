using System;
using Excel = Microsoft.Office.Interop.Excel;

class Program
{
    static void Main()
    {
        Excel.Application excelApp = null;
        Excel.Workbook workbook = null;

        try
        {
            // Start Excel application
            excelApp = new Excel.Application();
            
            // Make Excel visible (optional)
            excelApp.Visible = true; // Set to true for debugging, set to false for production

            // Path to the Excel file
            string filePath = @"C:\path\to\your\excel_file.xlsx";

            // Open the Excel file
            workbook = excelApp.Workbooks.Open(filePath);
            Excel.Worksheet worksheet = workbook.Sheets[1]; // Assumes the first worksheet

            // Get the used range excluding the header row
            Excel.Range usedRange = worksheet.UsedRange;
            int startRow = 2; // Start from the second row (assuming header is in row 1)

            // Add the formula with static text to each cell in column C starting from row 2
            for (int row = startRow; row <= usedRange.Rows.Count; row++)
            {
                Excel.Range cellC = worksheet.Cells[row, 3]; // Column C is index 3 (C is the 3rd column)
                cellC.Formula = "= \"pro\" & D" + row;
            }

            // Save and close the workbook
            workbook.Save();
            workbook.Close();

            Console.WriteLine("Formulas added successfully.");
        }
        catch (Exception ex)
        {
            Console.WriteLine("An error occurred: " + ex.Message);
        }
        finally
        {
            // Quit Excel application
            if (excelApp != null)
            {
                excelApp.Quit();
                System.Runtime.InteropServices.Marshal.ReleaseComObject(excelApp);
            }
        }
    }
}
