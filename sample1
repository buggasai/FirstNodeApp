using FlaUI.Core;
using FlaUI.Core.AutomationElements;
using FlaUI.Core.Input;
using System;

class Program
{
    static void Main(string[] args)
    {
        // Initialize FlaUI application
        var application = Application.AttachOrLaunch(new System.Diagnostics.ProcessStartInfo
        {
            FileName = "YourApplication.exe" // Replace this with the path to your application executable
        });

        // Get the main window of the application
        var window = application.GetMainWindow(TimeSpan.FromSeconds(10)); // Adjust the timeout as needed

        // Find the close button element
        var closeButton = window.FindFirstDescendant(cf => cf.ByControlType(FlaUI.Core.Definitions.ControlType.Button).And(cf.ByName("Close")));

        // Click on the close button
        closeButton?.Click();
    }
}
