using System;
using System.Runtime.InteropServices;
using Excel = Microsoft.Office.Interop.Excel;

class Program
{
    static void Main()
    {
        // Create a new Excel application
        Excel.Application excelApp = new Excel.Application();

        // Make the application visible (optional for demonstration)
        excelApp.Visible = true;

        // Define the path to the workbook
        string filePath = @"C:\path\to\your\file.xlsx";

        // Open the workbook
        Excel.Workbook workbook = excelApp.Workbooks.Open(filePath);

        // Define the worksheet name
        string worksheetName = "Sheet1"; // Replace with your worksheet name

        try
        {
            // Access the worksheet
            Excel.Worksheet worksheet = (Excel.Worksheet)workbook.Sheets[worksheetName];

            // Select cell A1
            Excel.Range cellA1 = worksheet.Range["A1"];
            cellA1.Select();

            // Get the used range of the worksheet
            Excel.Range usedRange = worksheet.UsedRange;

            // Apply sort filter A to Z on column A
            Excel.Range sortRange = worksheet.Range["A1", usedRange.Cells[usedRange.Rows.Count, 1]];

            // Create a sort object
            Excel.Sort sort = worksheet.Sort;
            sort.SortFields.Clear();
            sort.SortFields.Add(sortRange, Excel.XlSortOn.xlSortOnValues, Excel.XlSortOrder.xlAscending, Type.Missing, Excel.XlSortDataOption.xlSortNormal);

            // Set the sort range and apply the sort
            sort.SetRange(sortRange);
            sort.Header = Excel.XlYesNoGuess.xlYes;
            sort.MatchCase = false;
            sort.Orientation = Excel.XlSortOrientation.xlSortColumns;
            sort.SortMethod = Excel.Xl
