using System;
using System.Collections.Generic;
using System.Configuration;
using System.Linq;
using System.Runtime.InteropServices;
using Excel = Microsoft.Office.Interop.Excel;

class Program
{
    static void Main(string[] args)
    {
        // Read values from AppSettings
        string valuesToDeleteStr = ConfigurationManager.AppSettings["ValuesToDelete"];
        HashSet<int> valuesToDelete = new HashSet<int>(
            valuesToDeleteStr.Split(',')
                             .Select(int.Parse)
        );

        string filePath = @"C:\path\to\your\file.xlsx";
        string sheetName = "Sheet1"; // The sheet where the operation will be performed

        Excel.Application excelApp = new Excel.Application();
        Excel.Workbook workbook = null;
        Excel.Worksheet worksheet = null;

        try
        {
            // Open the workbook
            workbook = excelApp.Workbooks.Open(filePath);
            worksheet = workbook.Sheets[sheetName] as Excel.Worksheet;

            if (worksheet != null)
            {
                Excel.Range usedRange = worksheet.UsedRange;
                int lastRow = usedRange.Rows.Count;
                List<int> rowsToDelete = new List<int>();

                // Collect all rows that need to be deleted
                for (int row = 1; row <= lastRow; row++)
                {
                   
