using Excel = Microsoft.Office.Interop.Excel;

class Program
{
    static void Main(string[] args)
    {
        string filePath = "path_to_your_excel_file.xlsx";
        int columnIndex = 1; // Specify the index where you want to insert the new column (1-based index)
        int rowIndex = 3; // Specify the row index where you want to insert the new column (1-based index)
        
        // Create an Excel application object
        Excel.Application excelApp = new Excel.Application();
        excelApp.Visible = true; // Make Excel visible (for demonstration)
        
        // Open the Excel file
        Excel.Workbook workbook = excelApp.Workbooks.Open(filePath);
        Excel.Worksheet worksheet = workbook.Worksheets[1]; // Assuming you're working with the first worksheet
        
        // Insert a new column at the specified index
        Excel.Range range = (Excel.Range)worksheet.Cells[rowIndex, columnIndex];
        range.EntireColumn.Insert(Excel.XlInsertShiftDirection.xlShiftToRight, Excel.XlInsertFormatOrigin.xlFormatFromLeftOrAbove);
        
        // Set the column values from the DataTable
        // Assuming you have a DataTable named 'dataTable' containing the values to be inserted
        
        // Iterate over the rows of the DataTable
        for (int i = 0; i < dataTable.Rows.Count; i++)
        {
            // Get the value from the DataTable
            object value = dataTable.Rows[i]["ColumnName"]; // Replace "ColumnName" with the actual column name
            
            // Set the value in the Excel worksheet
            worksheet.Cells[rowIndex + i, columnIndex] = value;
        }
        
        // Save and close the workbook
        workbook.Save();
        workbook.Close();
        
        // Quit Excel application
        excelApp.Quit();
    }
}
