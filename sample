static void DisplayDifferences(DataTable sourceDataTable, DataTable targetDataTable, string comparisonColumn)
    {
        // Skip if the comparison column is not found in both DataTables
        if (!sourceDataTable.Columns.Contains(comparisonColumn) || !targetDataTable.Columns.Contains(comparisonColumn))
        {
            Console.WriteLine($"Column '{comparisonColumn}' not found in one or both DataTables");
            return;
        }

        // Compare rows based on the specified column ('empno')
        var differences = from sourceRow in sourceDataTable.AsEnumerable()
                          join targetRow in targetDataTable.AsEnumerable()
                          on sourceRow.Field<object>(comparisonColumn) equals targetRow.Field<object>(comparisonColumn)
                          into joined
                          from targetRow in joined.DefaultIfEmpty()
                          where targetRow == null || !sourceRow.ItemArray.SequenceEqual(targetRow.ItemArray)
                          select new
                          {
                              SourceRow = sourceRow,
                              TargetRow = targetRow,
                              IsDifferent = targetRow == null || !sourceRow.ItemArray.SequenceEqual(targetRow.ItemArray)
                          };

        // Display differences for the specified column
        Console.WriteLine($"Differences based on '{comparisonColumn}':");
        foreach (var diff in differences)
        {
            if (diff.IsDifferent)
            {
                Console.WriteLine($"- Source Row: {string.Join(", ", diff.SourceRow.ItemArray)}");
                Console.WriteLine($"  Target Row: {diff.TargetRow?.ItemArray.Aggregate("", (s, v) => s + (s == "" ? "" : ", ") + v)}");
                Console.WriteLine();
            }
        }
    }
