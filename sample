qq
using System.Data;
using System.Linq;

class Program
{
    static void Main()
    {
        // Sample source DataTable
        DataTable sourceDataTable = new DataTable();
        sourceDataTable.Columns.Add("ID", typeof(int));
        sourceDataTable.Columns.Add("Name", typeof(string));
        sourceDataTable.Rows.Add(1, "John");
        sourceDataTable.Rows.Add(2, "Jane");
        sourceDataTable.Rows.Add(3, "Doe");

        // Sample target DataTable with differences
        DataTable targetDataTable = new DataTable();
        targetDataTable.Columns.Add("ID", typeof(int));
        targetDataTable.Columns.Add("Name", typeof(string));
        targetDataTable.Rows.Add(1, "John");
        targetDataTable.Rows.Add(2, "JaneUpdated"); // Difference
        targetDataTable.Rows.Add(4, "NewPerson");   // Difference

        // Display differences between DataTables
        DisplayDifferences(sourceDataTable, targetDataTable);
    }

    static void DisplayDifferences(DataTable sourceDataTable, DataTable targetDataTable)
    {
        // Iterate through each column in the source DataTable
        foreach (DataColumn sourceColumn in sourceDataTable.Columns)
        {
            // Skip if the target DataTable does not contain the column
            if (!targetDataTable.Columns.Contains(sourceColumn.ColumnName))
            {
                Console.WriteLine($"Column '{sourceColumn.ColumnName}' not found in the target DataTable");
                continue;
            }

            // Compare values column by column
            var differences = from sourceRow in sourceDataTable.AsEnumerable()
                              join targetRow in targetDataTable.AsEnumerable()
                              on sourceRow.Field<object>(sourceColumn.ColumnName) equals targetRow.Field<object>(sourceColumn.ColumnName)
                              into joined
                              from targetRow in joined.DefaultIfEmpty()
                              where targetRow == null || !sourceRow[sourceColumn.ColumnName].Equals(targetRow[sourceColumn.ColumnName])
                              select new
                              {
                                  SourceValue = sourceRow[sourceColumn.ColumnName],
                                  TargetValue = targetRow?.Field<object>(sourceColumn.ColumnName),
                                  RowIndex = sourceDataTable.Rows.IndexOf(sourceRow) + 1
                              };

            // Display differences for the current column
            Console.WriteLine($"Differences in '{sourceColumn.ColumnName}':");
            foreach (var diff in differences)
            {
                Console.WriteLine($"- Row {diff.RowIndex}: Source='{diff.SourceValue}', Target='{diff.TargetValue ?? "N/A"}'");
            }

            Console.WriteLine();
        }
    }
}
