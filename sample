// Assuming you have references to Microsoft.Office.Interop.Excel
using Excel = Microsoft.Office.Interop.Excel;

// Open the Excel files
Excel.Application excelApp = new Excel.Application();
Excel.Workbook workbook1 = excelApp.Workbooks.Open("Path\\to\\File1.xlsx");
Excel.Workbook workbook2 = excelApp.Workbooks.Open("Path\\to\\File2.xlsx");

// Assuming your unique key is in column A
Excel.Worksheet worksheet1 = (Excel.Worksheet)workbook1.Worksheets[1];
Excel.Range range1 = worksheet1.UsedRange.Columns[1];

// Insert a new column for VLOOKUP results
Excel.Range newColumn1 = range1.Offset[0, range1.Columns.Count + 1];
newColumn1.EntireColumn.Insert(Excel.XlInsertShiftDirection.xlShiftToRight);

// Use VLOOKUP
foreach (Excel.Range cell in range1)
{
    int row = cell.Row;
    string uniqueKey = cell.Value.ToString();

    // Assuming VLOOKUP range is in column B of the second workbook
    string formula = "=VLOOKUP(" + uniqueKey + ", [" + workbook2.Name + "]Sheet1!$A:$B, 2, FALSE)";
    worksheet1.Cells[row, newColumn1.Column].Formula = formula;
}

// Save and close the workbooks
workbook1.Save();
workbook2.Save();
workbook1.Close();
workbook2.Close();

// Quit Excel application
excelApp.Quit();
