using Excel = Microsoft.Office.Interop.Excel;

class Program
{
    static void Main()
    {
        // Provide the file paths
        string filePath1 = "path_to_file1.xlsx";
        string filePath2 = "path_to_file2.xlsx";

        // Open Excel application
        Excel.Application excelApp = new Excel.Application();
        excelApp.Visible = true;

        // Open workbooks
        Excel.Workbook workbook1 = excelApp.Workbooks.Open(filePath1);
        Excel.Workbook workbook2 = excelApp.Workbooks.Open(filePath2);

        // Get the first worksheet from each workbook
        Excel.Worksheet worksheet1 = workbook1.Sheets[1];
        Excel.Worksheet worksheet2 = workbook2.Sheets[1];

        // Find the last row in each worksheet
        int lastRow1 = worksheet1.Cells[worksheet1.Rows.Count, "A"].End[Excel.XlDirection.xlUp].Row;
        int lastRow2 = worksheet2.Cells[worksheet2.Rows.Count, "A"].End[Excel.XlDirection.xlUp].Row;

        // Add a new column for the result in the first workbook
        Excel.Range resultColumn = worksheet1.Cells[1, lastRow1 + 1];
        resultColumn.Value = "Result";

        // Compare IDs and update the result column
        for (int row = 2; row <= lastRow1; row++)
        {
            string currentID = worksheet1.Cells[row, 1].Value.ToString();

            for (int row2 = 2; row2 <= lastRow2; row2++)
            {
                string compareID = worksheet2.Cells[row2, 1].Value.ToString();

                if (currentID == compareID)
                {
                    worksheet1.Cells[row, lastRow1 + 1].Value = "Match";
                    break;
                }
                else
                {
                    worksheet1.Cells[row, lastRow1 + 1].Value = "No Match";
                }
            }
        }

        // Save and close workbooks
        workbook1.Save();
        workbook1.Close();
        workbook2.Close();

        // Quit Excel application
        excelApp.Quit();
    }
}
