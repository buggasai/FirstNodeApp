using System;
using Microsoft.Office.Interop.Excel;

class Program
{
    static void Main()
    {
        string filePath = "YourFilePath.xlsx";  // Replace with the path to your Excel file
        RetrieveAndDeleteRows(filePath);
    }

    static void RetrieveAndDeleteRows(string filePath)
    {
        var excelApp = new Application();
        var workbook = excelApp.Workbooks.Open(filePath);
        var worksheet = (Worksheet)workbook.Sheets[1];

        // Retrieve data from the first two rows
        var range = worksheet.Range["A1", "Z2"];
        object[,] data = (object[,])range.Value;

        // Process the retrieved data
        Console.WriteLine("Retrieved Data:");
        for (int row = 1; row <= 2; row++)
        {
            for (int col = 1; col <= range.Columns.Count; col++)
            {
                Console.Write($"{data[row, col]}\t");
            }
            Console.WriteLine();
        }

        // Delete the first two rows
        range.Delete(XlDeleteShiftDirection.xlShiftUp);

        // Save and close the workbook
        workbook.Save();
        workbook.Close();
        excelApp.Quit();

        Console.WriteLine("First two rows deleted and changes saved.");
    }
}
