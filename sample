using Excel = Microsoft.Office.Interop.Excel;

class Program
{
    static void Main(string[] args)
    {
        string filePath = "path_to_your_excel_file.xlsx";
        string columnName = "empid"; // Specify the column name
        
        // Create an Excel application object
        Excel.Application excelApp = new Excel.Application();
        excelApp.Visible = true; // Make Excel visible (for demonstration)
        
        // Open the Excel file
        Excel.Workbook workbook = excelApp.Workbooks.Open(filePath);
        Excel.Worksheet worksheet = workbook.Worksheets[1]; // Assuming you're working with the first worksheet
        
        // Find the column index based on the column name
        int columnIndex = FindColumnIndex(worksheet, columnName);
        if (columnIndex == -1)
        {
            Console.WriteLine($"Column '{columnName}' not found.");
            return;
        }
        
        // Find the row index based on the empid value (for example, "123")
        int rowIndex = FindRowIndexByValue(worksheet, columnIndex, "123"); // Specify the empid value to search
        
        if (rowIndex == -1)
        {
            Console.WriteLine($"Value not found in column '{columnName}'.");
        }
        else
        {
            Console.WriteLine($"Row index of value '123' in column '{columnName}': {rowIndex}");
        }
        
        // Close the workbook and quit Excel application
        workbook.Close();
        excelApp.Quit();
    }
    
    static int FindColumnIndex(Excel.Worksheet worksheet, string columnName)
    {
        Excel.Range firstRow = worksheet.Rows[1]; // Assuming the column names are in the first row
        foreach (Excel.Range cell in firstRow.Cells)
        {
            if (cell.Value2.ToString() == columnName)
            {
                return cell.Column;
            }
        }
        return -1; // Column not found
    }
    
    static int FindRowIndexByValue(Excel.Worksheet worksheet, int columnIndex, string value)
    {
        Excel.Range column = worksheet.Columns[columnIndex];
        foreach (Excel.Range cell in column.Cells)
        {
            if (cell.Value2.ToString() == value)
            {
                return cell.Row;
            }
        }
        return -1; // Value not found
    }
}
