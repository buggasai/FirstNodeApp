  static void DisplayAndAddDifferenceColumnUsingLINQ(DataTable sourceDataTable, DataTable targetDataTable, string comparisonColumn)
    {
        // Skip if the comparison column is not found in both DataTables
        if (!sourceDataTable.Columns.Contains(comparisonColumn) || !targetDataTable.Columns.Contains(comparisonColumn))
        {
            Console.WriteLine($"Column '{comparisonColumn}' not found in one or both DataTables");
            return;
        }

        // Get the remaining column names dynamically
        var remainingColumnNames = sourceDataTable.Columns.Cast<DataColumn>()
            .Where(col => col.ColumnName != comparisonColumn)
            .Select(col => col.ColumnName)
            .ToArray();

        // Add a new column to the source DataTable for differences
        sourceDataTable.Columns.Add($"Difference_{comparisonColumn}", typeof(string));

        // Use LINQ to compare rows based on the specified column ('empno')
        var differences = from sourceRow in sourceDataTable.AsEnumerable()
                          join targetRow in targetDataTable.AsEnumerable()
                          on sourceRow.Field<object>(comparisonColumn) equals targetRow.Field<object>(comparisonColumn)
                          into joined
                          from targetRow in joined.DefaultIfEmpty()
                          where targetRow == null || !sourceRow.ItemArray.SequenceEqual(targetRow.ItemArray)
                          select new
                          {
                              SourceRow = sourceRow,
                              TargetRow = targetRow,
                              IsDifferent = targetRow == null || !sourceRow.ItemArray.SequenceEqual(targetRow.ItemArray)
                          };

        // Update the new column in the source DataTable
        foreach (var diff in differences)
        {
            if (diff.IsDifferent)
            {
                sourceDataTable.Rows.Cast<DataRow>()
                    .Single(row => row.ItemArray.SequenceEqual(diff.SourceRow.ItemArray))
                    .SetField($"Difference_{comparisonColumn}", GetDifferenceStringUsingLINQ(diff.SourceRow, remainingColumnNames, diff.TargetRow));
            }
        }

        // Display differences for the specified column
        Console.WriteLine($"Differences based on '{comparisonColumn}':");
        foreach (var diff in differences)
        {
            if (diff.IsDifferent)
            {
                Console.WriteLine($"- Source Row: {string.Join(", ", diff.SourceRow.ItemArray)}");
                Console.WriteLine($"  Target Row: {diff.TargetRow?.ItemArray.Aggregate("", (s, v) => s + (s == "" ? "" : ", ") + v)}");
                Console.WriteLine($"  Difference: {diff.SourceRow.Field<string>($"Difference_{comparisonColumn}")}");
                Console.WriteLine();
            }
        }
    }

    static string GetDifferenceStringUsingLINQ(DataRow sourceRow, string[] remainingColumns, DataRow targetRow)
    {
        // Compare values for the remaining columns using LINQ
        var differences = remainingColumns
            .Where(col => !sourceRow.Field<object>(col).Equals(targetRow?.Field<object>(col)))
            .Select(col => $"{col}: Source='{sourceRow[col]}', Target='{targetRow?.Field<object>(col) ?? "N/A"}'");

        return string.Join(", ", differences);
    }
