using System;
using Excel = Microsoft.Office.Interop.Excel;

class Program
{
    static void Main(string[] args)
    {
        string filePath = "path_to_your_excel_file.xlsx";
        string searchValue = "Value1"; // Specify the value you want to find
        
        // Create an Excel application object
        Excel.Application excelApp = new Excel.Application();
        excelApp.Visible = true; // Make Excel visible (for demonstration)
        
        // Open the Excel file
        Excel.Workbook workbook = excelApp.Workbooks.Open(filePath);
        Excel.Worksheet worksheet = workbook.Worksheets[1]; // Assuming you're working with the first worksheet
        
        // Find the row index based on the search value
        int rowIndex = FindRowIndexByValue(worksheet, searchValue);
        
        if (rowIndex == -1)
        {
            Console.WriteLine($"Value '{searchValue}' not found in the worksheet.");
        }
        else
        {
            Console.WriteLine($"Row index of value '{searchValue}': {rowIndex}");
        }
        
        // Close the workbook and quit Excel application
        workbook.Close();
        excelApp.Quit();
    }
    
    static int FindRowIndexByValue(Excel.Worksheet worksheet, string value)
    {
        Excel.Range usedRange = worksheet.UsedRange;
        foreach (Excel.Range cell in usedRange.Cells)
        {
            if (cell.Value2 != null && cell.Value2.ToString() == value)
            {
                return cell.Row;
            }
        }
        return -1; // Value not found
    }
}
