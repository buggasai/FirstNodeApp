using Excel = Microsoft.Office.Interop.Excel;

class Program
{
    static void Main()
    {
        string filePath = "path_to_your_excel_file.xlsx";
        int targetRow = 2; // Adjust as needed
        string targetColumnName = "ColumnName"; // Adjust as needed

        // Open Excel application
        Excel.Application excelApp = new Excel.Application();
        excelApp.Visible = true;

        // Open workbook
        Excel.Workbook workbook = excelApp.Workbooks.Open(filePath);
        Excel.Worksheet worksheet = (Excel.Worksheet)workbook.Sheets[1];

        // Get the column index based on the column name
        int targetColumn = GetColumnIndex(worksheet, targetColumnName);

        if (targetColumn != -1)
        {
            // Get the cell value
            string cellValue = GetCellValue(worksheet, targetRow, targetColumn);

            // Display the result
            Console.WriteLine($"Value at Row {targetRow}, Column {targetColumnName}: {cellValue}");
        }
        else
        {
            Console.WriteLine($"Column {targetColumnName} not found.");
        }

        // Close workbook
        workbook.Close();

        // Quit Excel application
        excelApp.Quit();
    }

    static int GetColumnIndex(Excel.Worksheet worksheet, string columnName)
    {
        for (int col = 1; col <= worksheet.UsedRange.Columns.Count; col++)
        {
            string header = (worksheet.Cells[1, col] as Excel.Range).Value.ToString();

            if (header == columnName)
            {
                return col;
            }
        }

        return -1; // Column not found
    }

    static string GetCellValue(Excel.Worksheet worksheet, int row, int col)
    {
        return (worksheet.Cells[row, col] as Excel.Range).Value.ToString();
    }
}
